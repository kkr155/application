import{d as C,r,o as V,c as o,b as s,i as h,a as E,j as A,u as B,p as D,w as M,k as w,F as k,f as S,l as y,v as b,t as f,h as n,E as $,_ as q}from"./index-DlVvhxd0.js";import{D as N,_ as F}from"./Dialog-C6w6rde9.js";import{s as g}from"./request-Ckln7nig.js";const I=()=>g({url:"/yuxin/users",method:"get"}),Y=i=>g({url:"/yuxin/addUser",method:"post",data:i}),j=i=>g({url:`/yuxin/deleteUser/${i}`,method:"delete"}),L={class:"form-group"},T={class:"form-group"},z={class:"form-group"},G=["disabled"],H={class:"user-management"},J={class:"user-list"},K={key:0,class:"loading"},O={key:1,class:"empty-state"},P={key:2},Q={class:"user-info"},R={class:"name"},W={class:"username"},X=["onClick","disabled"],Z=C({__name:"YuxinUserView",setup(i){const d=r(!1),u=r([]),c=r(!1),m=r(null),a=r({user_id:0,name:"",username:"",password:""}),v=r(!1),p=r(null),_=async()=>{try{c.value=!0,m.value=null;const l=await I();u.value=l.data}catch(l){m.value="获取用户列表失败",console.error("Error fetching users:",l)}finally{c.value=!1}},U=async()=>{try{v.value=!0;const l=await Y(a.value);l.code==200?(d.value=!1,a.value={user_id:0,name:"",username:"",password:""},await _()):$.error(l.message)}catch(l){console.error("Error Add User:",l),m.value="添加用户失败"}finally{v.value=!1}},x=async l=>{if(confirm("确定要删除这个用户吗？"))try{p.value=l,await j(l),u.value=u.value.filter(e=>e.user_id!==l)}catch(e){m.value="删除用户失败",console.error("Error deleting user:",e)}finally{p.value=null}};return V(()=>{_()}),(l,e)=>(n(),o(k,null,[s("button",{class:"fixed-toggle",onClick:e[0]||(e[0]=t=>d.value=!0)},[A(B(D))]),d.value?(n(),h(N,{key:0,onClick:e[4]||(e[4]=w(t=>d.value=!1,["self"]))},{default:M(()=>[e[8]||(e[8]=s("h2",null,"添加用户",-1)),s("form",{onSubmit:w(U,["prevent"])},[s("div",L,[e[5]||(e[5]=s("label",{for:"name"},"名字(用以区分是谁的账号)",-1)),y(s("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.name=t),type:"text",id:"name",required:""},null,512),[[b,a.value.name]])]),s("div",T,[e[6]||(e[6]=s("label",{for:"username"},"账号",-1)),y(s("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.username=t),type:"text",id:"username",required:""},null,512),[[b,a.value.username]])]),s("div",z,[e[7]||(e[7]=s("label",{for:"password"},"密码",-1)),y(s("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.password=t),type:"password",id:"password",required:""},null,512),[[b,a.value.password]])]),s("button",{class:"add-btn",type:"submit",disabled:v.value},f(v.value?"提交中...":"添加用户"),9,G)],32)]),_:1})):E("",!0),s("div",H,[s("div",J,[e[11]||(e[11]=s("h2",null,"用户列表",-1)),c.value?(n(),o("div",K,"加载中...")):u.value.length===0?(n(),o("div",O,[e[9]||(e[9]=s("img",{src:F,alt:"无数据",width:"120"},null,-1)),e[10]||(e[10]=s("p",null,"暂无用户数据",-1)),s("button",{onClick:_},"刷新数据")])):(n(),o("ul",P,[(n(!0),o(k,null,S(u.value,t=>(n(),o("li",{key:t.user_id,class:"user-item"},[s("div",Q,[s("span",R,f(t.name),1),s("span",W,"@"+f(t.username),1)]),s("button",{onClick:ee=>x(t.user_id),class:"delete-btn",disabled:p.value===t.user_id},f(p.value===t.user_id?"删除中...":"删除"),9,X)]))),128))]))])])],64))}}),ae=q(Z,[["__scopeId","data-v-27b38e7b"]]);export{ae as default};
